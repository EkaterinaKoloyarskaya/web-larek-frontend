# Проектная работа "Веб-ларек"

[Открыть документацию (PDF)](docs/UML-scheme.pdf)

#
## Описание проекта

Web-larёk — приложение интернет-магазина с товарами для веб-разработчиков.
В нем можно посмотреть товары, добавить в корзину и приобрести. Сайт предоставляет удобный интерфейс с модальными окнами для просмотра деталей товаров, управления корзиной и выбора способа оплаты, обеспечивая полный цикл покупки с отправкой заказов на сервер.

#
## Стек: 
HTML, SCSS, TS, Webpack

#
## Инструкция по сборке и запуску


Для установки и запуска проекта необходимо выполнить команды

- npm install
- npm run start

или

- yarn
- yarn start

Для сборки проекта необходимо выполнить команды:

- npm run build (или yarn build)

#
## Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

#
## Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

#
## Архитектура
Архитектура проекта разрабатывается с использованием паттерна MVP, в котором основными слоями являются:
- M - модель данных (отвечает за работу с данными), 
- V - компонент представления (отвечает за отображение данных на экране), 
- P - презентер (отвечает за синхронизацию модели и компонента представления).

Взаимодействие между классами обеспечивается использованием событийно-ориентированного подхода. Модели и Представления генерируют события при изменении данных или взаимодействии пользователя с приложением, а Презентер обрабатывает эти события используя методы как Моделей, так и Представлений.

#
## Слой данных 

1) interfaсe IItem: — отвечает за данные о товаре
- id: string — идентификатор товара(карточки)                     
- title: string — название товара                       
- image: string — изображение товара              
- category: string — категория, в которую входит товар                
- price: number | null — цена товара, может иметь стоимость или не иметь(быть бесценной)         
- descriptions: string — описание товара

2) interfaсe IBuyer: — отвечает за данные о покупателе
- payment?: 'card' | 'cash' — варианты оплаты
- address: string — адрес покупателя
- email: string — емайл покупателя
- phone: string — номер телефона покупателя

#
## Базовые код

Класс Item — хранит данные о товаре. 

Поля класса: 
- catalogItems[ ] — массив всех товаров. 
- selectedCard — выбранная карточка товара.
 
Методы класса: 

- getItems() — возвращает список товаров.
- saveSelectedCard() —  сохраняет выбранную карточку.
- getSelectedCard() — получает выбранную карточку.
- saveArrayItems() — сохраняет массив товаров.
#
Класс Basket — управляет корзиной пользователя. 

Поля класса:
- itemsAddedBasket[ ] — массив всех товаров, добавленных в корзину.

Методы класса:
- addItem() — добавляет товар в корзину.
- deleteItem() — удаляет товар из корзины.
- totalCostItems() — показывает стоимость всех товаров в корзине.
- amountItems() — показывает количество товаров в корзине.
- listItemsDelete() — список товаров, которые можно удалять.
- checkAvailabilityItem() — проверяет доступность товара к покупке.
#
Класс Buyer — хранит введенные пользователем данные.

Поля класса:
- payment — данные способа оплаты.
- address — данные адреса.
- email — данные почты.
- phone — данные номера телефона.

Методы класса:
- checkData() — проверяет правильность введенных данных.
- getData() — получает данные.
- saveData() — сохраняет данные.
#
Класс Api  - отвечает за взаимодействие с сервером.

Конструктор класса:  
- constructor(baseUrl: string, options: RequestInit = {}) - в конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.

Поля класса:
- baseUrl: string — базовый адрес сервера.
- options: RequestInit — объект с заголовками, которые будут использованы для запросов.

Методы класса:
- handleResponse(response: Response): Promise<object> — проверяет успешность запроса: если успешно — возвращает данные, если ошибка — возвращает ее текст.
- get(uri: string): Promise<object> — выполняет GET-запрос по указанному пути.
- post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object> — выполняет POST/PUT/DELETE-запрос с передачей данных.
#
Класс Component — базовый класс для всех компонентов интерфейса, предоставляющий инструменты для работы с DOM и управления отображением элементов. Позволяет дочерним классам обновлять интерфейс без прямого вмешательства в структуру HTML.

Конструктор класса:  
- constructor(container: HTMLElement) - принимает ссылку на DOM элемент за отображение, которого он отвечает.

Поля класса:
- container: HTMLElement — поле для хранения корневого DOM элемента компонента.

Методы класса:

- render(data?: Partial<T>): HTMLElement — Главный метод класса. Он принимает данные, которые необходимо отобразить в интерфейсе, записывает эти данные в поля класса и возвращает ссылку на DOM-элемент. Предполагается, что в классах, которые будут наследоваться от Component будут реализованы сеттеры для полей с данными, которые будут вызываться в момент вызова render и записывать данные в необходимые DOM элементы.  
- setImage(element: HTMLImageElement, src: string, alt?: string): void - утилитарный метод для модификации DOM-элементов <img>.
#
## Слой отображения (Компоненты)

Класс HeaderBasket — отображает корзину в шапке на главной странице.

Поля класса:
- buttonBasket: HTMLButtonElement — ссылка на элемент кнопки в корзине.
- basketCounter: HTMLElement — ссылка на элемент счетчика  корзины.

Методы класса:
- set counter(value: number) — перерисовывает значение счетчика.
#
Класс Gallary  — отображает карточки на странице.

Поля класса:
- catalogElement: HTMLElement — ссылка на каталог с карточками.

Методы класса:
- set catalog(items: HTMLElement[]) —  устанавливает новые элементы в каталоге.
#
Класс Modal — отображает модальное окно, куда рендерится сущностии: OrderSuccess, CardBasket, FormOrder, CardPreview.

Поля класса:
- modalClose: HTMLButtonElement — ссылка на кнопку закрытия модального окна.
- modalContent: HTMLElement — ссылка на контент внутри модального окна.

Методы класса:
- set content(content: HTMLElement) — устанавливает новые значения элемента.
#
Класс OrderSuccess — отображает успешно созданный заказ.

Поля класса:
- successTitle: HTMLElement — ссылка на название успешного заказа.
- successDescription: HTMLElement — ссылка на описание текса успешного заказа.
- buttonOrderSuccessClose:  HTMLButtonElement — ссылка на кнопку успешного заказа.
#
Класс Form - форма с общими элементами для других форм.

Поля класса:
- formElement: HTMLFormElement — ссылка на форму.
- formButton: HTMLButtonElement — ссылка на кнопку формы.

Методы класса:
- set content(content: HTMLFormElement) — устанавливает новые значения элемента.
#
Класс FormContacts — отображает данные покупателя.
Свойства класса:
- formEmail: HTMLElement — ссылка на поле ввода почты.
- formNumber:  HTMLElement — ссылка на поле ввода номера телефона.


Класс FormOrder — отображает данные заказа.

Поля класса:
- buttonCard: HTMLButtonElement — ссылка на кнопку оплаты по карте.
- buttonCash: HTMLButtonElement — ссылка на кнопку оплаты наличными.
- formAddress: HTMLElement – ссылка на поле ввода адреса.
#
Класс Card — отображает общие элементы карточек. 

Поля класса:
- cardTitle: HTMLElement — ссылка на название товара в карточке.
- cardPrice: HTMLElement — ссылка на цену товара в карточке.

Методы класса:
- set content(content: HTMLElement) — устанавливает новые значения элемента.
#
Класс CardPreview — показывает одну карточку.

Поля класса:
- cardCategoryOther: HTMLElement — ссылка на категорию "другое".
- cardText: HTMLElement — ссылка на текст описания товара в карточке.
- cardButton: HTMLButtonElement — ссылка на кнопку в самой карточке.
#
Класс CardCatalog — показывает список карточек на главной странице.

Поля класса:
- cardGallery: HTMLButtonElement — ссылка на кнопку карточки товара в галерее.
- cardCategorySoft: HTMLElement — ссылка на категорию товара.
#
Класс CardBasket — показывает карточки, добавленные в корзину.

Поля класса:
- basketItemIndex: HTMLElement – ссылка на порядковый номер товара в корзине.
- basketItemDelete: HTMLButtonElement — ссылка на кнопку удаления товара из корзины.


#
## Слой Presenter

Класс EventEmitter — брокер событий: позволяет подписываться на события, отписываться от них и уведомлять все подписанные компоненты об изменениях, благодаря чему разные части приложения могут общаться между собой без прямой связи.

Поля класса:
- _events: Map<string | RegExp, Set<Function>> — хранилище всех событий и их подписчиков(функций). Ключи коллекции - названия событий или регулярное выражение, значения - коллекция функций обработчиков, которые будут вызваны при срабатывании события.

Методы класса:
- on<T extends object>(event: EventName, callback: (data: T) => void): void — подписка на событие, принимает название события и функцию обработчик.
- emit<T extends object>(event: string, data?: T): void — создает событие. При вызове события в метод передается название события и объект с данными, который будет использован как аргумент для вызова обработчика.  
- trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void — возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие с передачей в него данных из второго параметра.

#
### Обмен данными между слоями будет реализован с помощью брокера событий.

Список событий генерируемых в системе:
- 'item: changed' — сохранён каталог товаров
- 'item: cardSelected' — выбрана карточка
- 'items: loaded' — товары успешно загружены.
- 'items: loadFailed' — ошибка при загрузке товаров
- 'card: hovered' — пользователь навёл мышку на карточку
- 'basket: changed' — изменён состав корзины
- 'basket: cardAdded' — добавлена карточка в корзину
- 'basket: cardDeleted' — удалена карточка из корзины
- 'basket: quantityChanged' — изменилось количество товара
- 'basket: emptied' — корзина очищена
- 'buyer: emailAdded' — введён email
- 'buyer: phoneAdded' — введён номер телефона
- 'buyer: addressAdded' — введён адрес
- 'order: paymentSelected' — выбран способ оплаты
- 'order: success' — заказ успешно создан
- 'order: sendFailed' — ошибка при отправке заказа на сервер
- 'modal: opened' — открыто модальное окно
- 'modal: closed' — закрыто модальное окно
- 'button: clicked' — пользователь нажал кнопку
- 'form: submitted' — форма отправлена
- 'form: reset' — форма очищена 
- 'form: validationError' — данные формы не прошли проверку

